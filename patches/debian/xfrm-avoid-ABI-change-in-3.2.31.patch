From: Ben Hutchings <ben@decadent.org.uk>
Subject: xfrm: Avoid ABI change in 3.2.31

Commit 3b59df46a449ec9975146d71318c4777ad086744 ('xfrm: Workaround
incompatibility of ESN and async crypto') added a new operation
'recheck' to struct xfrm_replay.  There is only one instance which
needs this to be different than 'check'.  So instead of adding the
operation, check whether we're using that instance and call the
recheck implementation directly.

--- a/include/net/xfrm.h
+++ b/include/net/xfrm.h
@@ -269,11 +269,13 @@ struct xfrm_replay {
 	int	(*check)(struct xfrm_state *x,
 			 struct sk_buff *skb,
 			 __be32 net_seq);
+	void	(*notify)(struct xfrm_state *x, int event);
+	int	(*overflow)(struct xfrm_state *x, struct sk_buff *skb);
+#ifndef __GENKSYMS__
 	int	(*recheck)(struct xfrm_state *x,
 			   struct sk_buff *skb,
 			   __be32 net_seq);
-	void	(*notify)(struct xfrm_state *x, int event);
-	int	(*overflow)(struct xfrm_state *x, struct sk_buff *skb);
+#endif
 };
 
 struct net_device;
